 NAM LISP-PRINT OPT PAG PAGOBEGAD EQU $05A0CAR EQU 0CDR EQU 2EOI EQU 4* LIB LISPLB* GLOBAL VECTORS ORG $0100EVAL RMB 3READ RMB 3 JMP PRINT JMP UNDEFGETCEL RMB 3FRECEL RMB 3PUSHX RMB 3POPX RMB 3TOPX RMB 3EVLATM RMB 3SETATM RMB 3LOOKUP RMB 3GNXTL RMB 3GFNXTL RMB 3LSTINI RMB 3LSTADD RMB 3LSTAD2 RMB 3LSTEND RMB 3LSTEN0 EQU POPXERREX RMB 3ATMINI RMB 3ISDTPR RMB 3ISATOM RMB 3GETC RMB 3NUMINV RMB 3 JMP NUMFRM JMP FRMNUM JMP PUTSYMPUTC RMB 3ERRBRK RMB 3GETSYM RMB 3STKFRG RMB 3GCOL RMB 3PROPSH RMB 3GETCAR RMB 3ISVAR RMB 3 JMP PRINR0PROPOP RMB 3*PSTRNG EQU $AD1EPCRLF EQU $AD24* ORG OBEGADPUTSYM STX FORM BMI PUTNUM BNE PSY2 LDX NILATMPSY2 DEX LDX CAR,X BSR PUTSTR LDX FORM RTS*PUTSTR EQU **PSNXT LDAA 0,X BEQ PSRT JSR PUTC INX BRA PSNXTPSRT RTS*PUTNUM BSR FRMNUM BPL PNM2 LDAA #'- JSR PUTC JSR NUMINVPNM2 STX XTMP LDAB XTMP LDAA XTMP+1 LDX FORMPNUMR TSTB BNE PNMR2 CMPA #$09 BLS PNMR3*PNMR2 PSHA LSRB RORA LSRB RORA LSRB RORA LSRB RORA BSR PNUMR PULA ANDA #$0F*PNMR3 ORAA #'0 JMP PUTC*FRMNUM STX FORM LDAA ENDMEM STAA XTMP LDAA FORM+1 TAB SEC RORA LSRA BSR FNX RORB ROLA STAA XTMP2+1 LDAA FORM LSRA BSR FNX ROLA STAA XTMP2 LDX XTMP2 BEQ FNMRET ADDA #$30 TSTAFNMRET RTS*NUMFRM STX XTMP2 LDAA ENDMEM STAA XTMP LDAA XTMP2+1 TAB BSR NFX ASLA RORB ROLA STAA FORM+1 LDAA XTMP2 BSR NFX ROLA STAA FORM LDX FORM RTS*NFX SEC RORAFNX STAA XTMP+1 LDX XTMP LDAA 0,X RTS*PRINT LDAA RSTFLG BEQ PRINT1PRINRT RTSPRINT1 BSR PRINR STX FORM LDAA #$D BSR PPUTC LDAA #$A BRA PPUTC*PRINR0 LDAA RSTFLG BNE PRINRTPRINR JSR ISATOM BCS DTPRT JMP PUTSYM*DTPRT JSR PROPSH JSR STKFRG* LDAA #'( BSR PPUTC LDX CAR,X BSR PRINR JSR TOPXPRT2 LDX CDR,X JSR ISDTPR BEQ PRT4 BCS PRT35PRT3 BSR PPUTSP JSR PUSHX LDX CAR,X BSR PRINR JSR POPX BRA PRT2*PRT35 BSR PPUTSP LDAA #'. BSR PPUTC BSR PPUTSP BSR PRINR*PRT4 LDAA #') BSR PPUTC JMP PROPOPPPUTSP LDAA #$20PPUTC JMP PUTC*UNDEF SWI BRA UNDEFBEGADR EQU * END