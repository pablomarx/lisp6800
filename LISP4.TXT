 NAM LISP-EVALSUBS OPT PAG PAGOBEGAD EQU $0940CAR EQU 0CDR EQU 2EOI EQU 4* LIB LISPLB4* GLOBAL VECTORS ORG $0100 JMP EVALREAD RMB 3PRINT RMB 3 RMB 3GETCEL RMB 3FRECEL RMB 3PUSHX RMB 3POPX RMB 3TOPX RMB 3 JMP EVLATM JMP SETATMLOOKUP RMB 3 JMP GNXTL JMP GFNXTL JMP LSTINI JMP LSTADD JMP LSTAD2 JMP LSTEND*ERREX RMB 3ATMINI RMB 3 JMP ISDTPR JMP ISATOMGETC RMB 3NUMINV RMB 3NUMFRM RMB 3FRMNUM RMB 3PUTSYM RMB 3PUTC RMB 3ERRBRK RMB 3GETSYM RMB 3STKFRG RMB 3GCOL RMB 3PROPSH RMB 3GETCAR RMB 3ISVAR RMB 3PRINR RMB 3PROPOP RMB 3* ORG OBEGAD*EVAL TST RSTFLG BNE EVLEOI JSR ISATOM BCS EVLDTP BLE EVLRTEVLATM LDX CDR-1,XEVLRT STX FORM RTSEVLEOI LDX EOIATM BRA EVLRTEVLDTP STX FORM JSR STKFRG LDAA ALP+1 PSHA LDAA ALP PSHA LDAA NLP+1 PSHA LDAA NLP PSHA LDAA FLP+1 PSHA LDAA FLP PSHA JSR GETCEL LDAA FORM STAA CAR,X LDAA FORM+1 STAA CAR+1,X LDAA CUREVL STAA CDR,X LDAA CUREVL+1 STAA CDR+1,X STX CUREVL LDX FORM LDX CDR,X STX ALP LDX FORM LDX CAR,X BSR EVAL JSR ISDTPR BCS EVLERR* STX FORM LDX CDR,X STX FLP LDX FORM LDX CAR,X CPX SUBRAT BEQ EVLSUB CPX NSUBAT BEQ EVLNSU CPX LAMATM BEQ EVLLAM CPX NLAMAT BEQ EVLNLA*EVLERR LDX #EVLEMS BRA EVLER2*EVLNSU LDX ZERO JSR PROPSH BRA EVNSU2*EVLSUB BSR EVLALS LDX EOIATM TST RSTFLG BNE EVLSB5*EVNSU2 LDX FLP JSR ISATOM BCS EVLSER BLE EVLSER DEX LDX CAR,X LDAA 0,X CMPA #'! BNE EVLSER TST 1,X BNE EVLSER* JSR 2,XEVLSB5 STX FORM BSR POPFRE BRA EVLRT5*EVLSER BSR POPFRE LDX #EVLSMS*EVLER2 JSR ERRBRK BRA EVLRT4*EVLALS JSR LSTINIEVLSB2 LDX ALP JSR GNXTL BCS EVLSB3 STX ALP LDX XTMP JSR EVAL JSR LSTADD BRA EVLSB2*EVLSB3 JSR LSTEN0 JSR TOPX STX ALP RTS*EVLNLA JSR LSTINI LDX ALP JSR LSTADD JSR LSTEN0 BRA EVLNL2*EVLLAM BSR EVLALSEVLNL2 BSR EVLNSV*EVLBOD LDX FLP JSR GETCAR JSR EVAL STX FLP BSR EVLRST LDX FLP*EVLRT4 STX FORMEVLRT5 LDX CUREVL BSR GFNXTA LDX ALP STX CUREVL PULA STAA FLP PULA STAA FLP+1 PULA STAA NLP PULA STAA NLP+1 PULA STAA ALP PULA STAA ALP+1 LDX FORM RTS*POPFRE JSR PROPOP BEQ PFRDUNPFR2 BSR GFNXTAPFR3 LDX ALP BNE PFR2PFRDUN RTS*GFNXTA LDAA CDR,X STAA ALP LDAA CDR+1,X STAA ALP+1 JMP FRECEL*EVLRST JSR PROPOP STX NLPEVLRS0 JSR PROPOPEVLRS1 STX ALP BEQ EVLRS3EVLRS2 BSR GFNXTA LDX CAR,XEVLRS3 STX FORM LDX NLP JSR GNXTL BCS PFR3 STX NLP LDX XTMP JSR SETATM LDX ALP BEQ EVLRS3 BRA EVLRS2*EVLNSV LDX STKPTR DEX DEX STX ALP* LDX FLP JSR GNXTL STX FLP LDX XTMP JSR PROPSH*EVLNS1 JSR GNXTL BCS EVLNS5 STX NLP* LDX ALP LDX CDR,X BNE EVLNS2* JSR GETCEL LDX ALP LDAA CELPTR STAA CDR,X LDAA CELPTR+1 STAA CDR+1,X LDX CELPTR*EVLNS2 STX ALP LDX CAR,X STX XTMP2* LDX XTMP JSR ISVAR BCS EVLNER JSR EVLATM* LDX ALP LDAA FORM STAA CAR,X LDAA FORM+1 STAA CAR+1,X* LDX XTMP2 STX FORM LDX XTMP JSR SETATM LDX NLP BNE EVLNS1*EVLNS5 RTS*EVLNER STX FORM LDX #EVLNMS JSR ERRBRK BRA EVLNS5*ISDTPR SEC STX XTMP BLE ISDTRT LDAA XTMP+1 RORA LDX XTMPISDTRT RTS*ISATOM CLC STX XTMP BLE ISATRT LDAA XTMP+1 INCA RORA LDX XTMPISATRT RTS*LSTINI LDX ZERO JSR PROPSH LDX STKPTR*LSTINX DEX DEX JMP PUSHX*LSTADD STX FORMLSTAD2 JSR GETCEL LDAA FORM STAA CAR,X LDAA FORM+1 STAA CAR+1,X JSR TOPX LDAA CELPTR STAA CDR,X LDAB CELPTR+1 STAB CDR+1,X LDX STKPTR STAA CAR,X STAB CAR+1,X RTS*LSTEND STX FORMLSTEN2 JSR POPX LDAA FORM STAA CDR,X LDAA FORM+1 STAA CDR+1,X RTS*LSTEN0 EQU POPX*GNXTL STX XTMP BLE GNLNO LDAA XTMP+1 RORA BCS GNLNO LDAA CAR,X STAA XTMP LDAA CAR+1,X STAA XTMP+1 LDX CDR,X RTS*GNLNO LDX ZERO STX XTMP SEC RTS*GFNXTL JSR ISDTPR BCS GNLNO LDAA CDR,X STAA XTMP2 LDAA CDR+1,X STAA XTMP2+1 JSR FRECEL LDX CAR,X STX XTMP LDX XTMP2 CLC RTS*SETATM LDAA FORM STAA CDR-1,X LDAA FORM+1 STAA CDR+1-1,X RTS*EVLSMS FCC 'BAD SUBR/NSUBR' FCB 4EVLNMS FCC 'BAD FORMAL ARG' FCB 4EVLEMS FCC 'ILLEGAL FUNCTION EVAL' FCB 4*BEGADR EQU * END